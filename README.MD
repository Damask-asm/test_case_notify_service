
# üì¨ Notify Service

**Notify Service** ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ Django, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π –º–Ω–æ–≥–æ–∫–∞–Ω–∞–ª—å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π (Email, SMS, Telegram –∏ –¥—Ä.) —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä—è–µ–º—É—é —Å–∏—Å—Ç–µ–º—É –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤.

---

## üì¶ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –∞–≤—Ç–æ-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∫–∞–Ω–∞–ª–æ–≤
- üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ Email, SMS, Telegram
- ‚öôÔ∏è –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏
- üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ API-–∫–ª—é—á—É (permissions)
- üìö –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI —Å—Ö–µ–º —á–µ—Ä–µ–∑ drf-spectacular

---

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3.12+
- Django 5.x
- Django REST Framework
- drf-spectacular
- Celery (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/Damask-asm/test_case_notify_service.git
cd notify_service
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

### 3. –°–æ–∑–¥–∞–π `.env` —Ñ–∞–π–ª:

```ini
DEBUG=True
SECRET_KEY=your-secret-key
ALLOWED_HOSTS=127.0.0.1,localhost
EMAIL_HOST=smtp.example.com
EMAIL_HOST_USER=user@example.com
EMAIL_HOST_PASSWORD=secret
REDIS_URL=redis://localhost:6379/0
```

### 4. –ü—Ä–∏–º–µ–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä:

```bash
python manage.py migrate
python manage.py runserver
```

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
notify_service/
‚îú‚îÄ‚îÄ manage.py
‚îú‚îÄ‚îÄ notify_service/              # Django settings, urls
‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îú‚îÄ‚îÄ urls.py
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ notifications/               # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ views.py
‚îÇ   ‚îú‚îÄ‚îÄ permissions.py
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py
‚îÇ   ‚îú‚îÄ‚îÄ channels/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ registry.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notifiers/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ email.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ sms.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ telegram.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ ...
```

---

## üì§ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–∞–Ω–∞–ª–∞

# üì§ Notify Service ‚Äî –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

Notify Service –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é** –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–∏–º–ø–æ—Ä—Ç–∞.

## üîß –®–∞–≥ 1: –°–æ–∑–¥–∞–π —Ñ–∞–π–ª –≤ `notifications/channels/notifiers/`

–ù–∞–ø—Ä–∏–º–µ—Ä, `whatsapp.py`:

```python
from notifications.channels.base import BaseNotifier

class WhatsAppNotifier(BaseNotifier):
    def send(self, message: str, user: UserNotification):
        # –∑–¥–µ—Å—å –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        ...
```

> ‚ö†Ô∏è –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –¥–æ–ª–∂–Ω–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å `BaseNotifier`. –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∫–∞–∫ `code` –∫–∞–Ω–∞–ª–∞.

---

## üîÅ –®–∞–≥ 2: –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

1. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ Django-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `notifications` –∑–∞–≥—Ä—É–∑–∏—Ç –º–æ–¥—É–ª—å `registry.py`.
2. –í—ã–∑–æ–≤–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `load_channels()`, –∫–æ—Ç–æ—Ä–∞—è:
   - –°–∫–∞–Ω–∏—Ä—É–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `notifiers/`
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ `.py` —Ñ–∞–π–ª—ã (–∫—Ä–æ–º–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö)
   - –ù–∞—Ö–æ–¥–∏—Ç –∫–ª–∞—Å—Å—ã-–Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ `BaseNotifier`
   - –î–æ–±–∞–≤–ª—è–µ—Ç –∏—Ö –≤ `CHANNEL_REGISTRY` —Å –∫–ª—é—á–æ–º `code = –∏–º—è_—Ñ–∞–π–ª–∞` –∏ `label = –ò–º—è_–§–∞–π–ª–∞.capitalize()`

---

## üìç –®–∞–≥ 3: –ì–¥–µ –ø–æ—è–≤–∏—Ç—Å—è –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª

### üß± 1. –í –±–∞–∑–µ (–≤ –∞–¥–º–∏–Ω–∫–µ)

–ú–æ–¥–µ–ª—å `UserNotification` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `channel` —Å `choices=CHANNEL_CHOICES`, —Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:

- –ù–æ–≤—ã–π –∫–∞–Ω–∞–ª **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ `select` –ø–æ–ª–µ** –≤ –∞–¥–º–∏–Ω–∫–µ
- –¢–µ–±–µ **–Ω–µ –Ω—É–∂–Ω–æ –º–∏–≥—Ä–∞—Ü–∏–π**, `CHANNEL_CHOICES` –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏

### üåê 2. –í API (DRF)

–í —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–µ –ø–æ–ª–µ `channel` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `choices=CHANNEL_CHOICES`:

- –í **Swagger/Redoc** –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª –ø–æ—è–≤–∏—Ç—Å—è –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ API —Ç–æ–∂–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### üõ†Ô∏è 3. –í –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ

`CHANNEL_REGISTRY[channel].notifier_class().send(...)`, –∫–∞–Ω–∞–ª –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω **—Å—Ä–∞–∑—É**, –±–µ–∑ —Ä—É—á–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

```python
from notifications.channels import CHANNEL_REGISTRY

def send_notification(notification: UserNotification):
    notifier = CHANNEL_REGISTRY[notification.channel].notifier_class()
    notifier.send(notification.message, notification)
```

---

## üìä –ò—Ç–æ–≥–æ

| –î–µ–π—Å—Ç–≤–∏–µ                               | –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| -------------------------------------- | ------------- | ------------- |
| –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ `notifiers/`          | ‚úÖ             |               |
| –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ                  |               | ‚úÖ             |
| –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ DRF/Swagger              |               | ‚úÖ             |
| –ü–æ—è–≤–ª–µ–Ω–∏–µ –≤ Django Admin               |               | ‚úÖ             |
| –ú–∏–≥—Ä–∞—Ü–∏–∏ (`choices` –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ) | ‚ùå             | ‚úÖ             |

---

## üß© –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–≤–ª—è–µ–º—É—é –º–æ–¥–µ–ª—å `NotificationChannel` —Å —Ñ–ª–∞–≥–æ–º `enabled`, —á—Ç–æ–±—ã —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å –∫–∞–Ω–∞–ª—ã, –Ω–µ —É–¥–∞–ª—è—è –∫–æ–¥.


---

## üìò –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:

- Swagger: [`/api/schema/swagger/`](http://localhost:8000/api/schema/swagger/)
- ReDoc: [`/api/schema/redoc/`](http://localhost:8000/api/schema/redoc/)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
python manage.py test
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ¬© 2025 –•—Ä–∞–º–æ–≤ –ê–Ω–¥—Ä–µ–π –í–∏—Ç–∞–ª—å–µ–≤–∏—á

---

## üß† –ê–≤—Ç–æ—Ä

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: [–ê–Ω–¥—Ä–µ–π –•—Ä–∞–º–æ–≤](https://t.me/andrew_developer)
```